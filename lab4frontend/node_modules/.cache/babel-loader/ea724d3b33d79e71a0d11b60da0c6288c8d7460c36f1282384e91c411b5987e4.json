{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { defineStore } from 'pinia';\nimport { ref } from 'vue';\nimport axios from 'axios';\nexport const useAuthStore = defineStore('auth', () => {\n  const user = ref(null);\n  const error = ref(null);\n  const fetchUser = async () => {\n    try {\n      const response = await axios.get(\"http://localhost:8000/api/user/\");\n      user.value = response.data;\n      error.value = null;\n    } catch (err) {\n      user.value = null;\n      error.value = err.response?.data?.message || \"Ошибка получения пользователя\";\n    }\n  };\n  const login = async credentials => {\n    try {\n      const response = await axios.post(\"http://localhost:8000/auth/login\", new URLSearchParams({\n        username: credentials.username,\n        password: credentials.password\n      }), {\n        headers: {\n          'Content-Type': 'application-x-www-form-urlencoded'\n        }\n      });\n      if (response.status === 200 && response.data === \"Вход был успешно выполнен\") {\n        await fetchUser();\n      } else {\n        throw new Error(\"Неверный логин или пароль\");\n      }\n    } catch (err) {\n      error.value = err.response?.data?.message || \"Ошибка входа.\";\n    }\n  };\n  const logout = async () => {\n    try {\n      await axios.post(\"http://localhost:8000/auth/logout\");\n      user.value = null;\n      error.value = null;\n    } catch (err) {\n      error.value = err.response?.data?.message || \"Ошибка выхода.\";\n    }\n  };\n  return {\n    user,\n    error,\n    login,\n    logout,\n    fetchUser\n  };\n});","map":{"version":3,"names":["defineStore","ref","axios","useAuthStore","user","error","fetchUser","response","get","value","data","err","message","login","credentials","post","URLSearchParams","username","password","headers","status","Error","logout"],"sources":["C:/study/labs/web/weblab4/front-vue/src/auth.js"],"sourcesContent":["import {defineStore} from 'pinia';\r\nimport {ref} from 'vue';\r\nimport axios from 'axios';\r\n\r\nexport const useAuthStore = defineStore('auth', () => {\r\n    const user = ref(null);\r\n    const error = ref(null);\r\n\r\n    const fetchUser = async () => {\r\n        try {\r\n            const response = await axios.get(\"http://localhost:8000/api/user/\");\r\n            user.value = response.data;\r\n            error.value = null;\r\n        } catch (err) {\r\n            user.value = null;\r\n            error.value = err.response?.data?.message || \"Ошибка получения пользователя\";\r\n        }\r\n    }\r\n\r\n    const login = async (credentials) => {\r\n        try {\r\n            const response = await axios.post(\"http://localhost:8000/auth/login\",\r\n                new URLSearchParams({\r\n                    username: credentials.username,\r\n                    password: credentials.password,\r\n                }),\r\n                {headers: {'Content-Type': 'application-x-www-form-urlencoded'}});\r\n            if (response.status === 200 && response.data === \"Вход был успешно выполнен\") {\r\n                await fetchUser();\r\n            } else {\r\n                throw new Error(\"Неверный логин или пароль\");\r\n            }\r\n        } catch (err) {\r\n            error.value = err.response?.data?.message || \"Ошибка входа.\";\r\n        }\r\n    }\r\n\r\n    const logout = async () => {\r\n        try {\r\n            await axios.post(\"http://localhost:8000/auth/logout\");\r\n            user.value = null;\r\n            error.value = null;\r\n        } catch (err) {\r\n            error.value = err.response?.data?.message || \"Ошибка выхода.\";\r\n        }\r\n    }\r\n\r\n    return {user, error, login, logout, fetchUser};\r\n})"],"mappings":";;;AAAA,SAAQA,WAAW,QAAO,OAAO;AACjC,SAAQC,GAAG,QAAO,KAAK;AACvB,OAAOC,KAAK,MAAM,OAAO;AAEzB,OAAO,MAAMC,YAAY,GAAGH,WAAW,CAAC,MAAM,EAAE,MAAM;EAClD,MAAMI,IAAI,GAAGH,GAAG,CAAC,IAAI,CAAC;EACtB,MAAMI,KAAK,GAAGJ,GAAG,CAAC,IAAI,CAAC;EAEvB,MAAMK,SAAS,GAAG,MAAAA,CAAA,KAAY;IAC1B,IAAI;MACA,MAAMC,QAAQ,GAAG,MAAML,KAAK,CAACM,GAAG,CAAC,iCAAiC,CAAC;MACnEJ,IAAI,CAACK,KAAK,GAAGF,QAAQ,CAACG,IAAI;MAC1BL,KAAK,CAACI,KAAK,GAAG,IAAI;IACtB,CAAC,CAAC,OAAOE,GAAG,EAAE;MACVP,IAAI,CAACK,KAAK,GAAG,IAAI;MACjBJ,KAAK,CAACI,KAAK,GAAGE,GAAG,CAACJ,QAAQ,EAAEG,IAAI,EAAEE,OAAO,IAAI,+BAA+B;IAChF;EACJ,CAAC;EAED,MAAMC,KAAK,GAAG,MAAOC,WAAW,IAAK;IACjC,IAAI;MACA,MAAMP,QAAQ,GAAG,MAAML,KAAK,CAACa,IAAI,CAAC,kCAAkC,EAChE,IAAIC,eAAe,CAAC;QAChBC,QAAQ,EAAEH,WAAW,CAACG,QAAQ;QAC9BC,QAAQ,EAAEJ,WAAW,CAACI;MAC1B,CAAC,CAAC,EACF;QAACC,OAAO,EAAE;UAAC,cAAc,EAAE;QAAmC;MAAC,CAAC,CAAC;MACrE,IAAIZ,QAAQ,CAACa,MAAM,KAAK,GAAG,IAAIb,QAAQ,CAACG,IAAI,KAAK,2BAA2B,EAAE;QAC1E,MAAMJ,SAAS,CAAC,CAAC;MACrB,CAAC,MAAM;QACH,MAAM,IAAIe,KAAK,CAAC,2BAA2B,CAAC;MAChD;IACJ,CAAC,CAAC,OAAOV,GAAG,EAAE;MACVN,KAAK,CAACI,KAAK,GAAGE,GAAG,CAACJ,QAAQ,EAAEG,IAAI,EAAEE,OAAO,IAAI,eAAe;IAChE;EACJ,CAAC;EAED,MAAMU,MAAM,GAAG,MAAAA,CAAA,KAAY;IACvB,IAAI;MACA,MAAMpB,KAAK,CAACa,IAAI,CAAC,mCAAmC,CAAC;MACrDX,IAAI,CAACK,KAAK,GAAG,IAAI;MACjBJ,KAAK,CAACI,KAAK,GAAG,IAAI;IACtB,CAAC,CAAC,OAAOE,GAAG,EAAE;MACVN,KAAK,CAACI,KAAK,GAAGE,GAAG,CAACJ,QAAQ,EAAEG,IAAI,EAAEE,OAAO,IAAI,gBAAgB;IACjE;EACJ,CAAC;EAED,OAAO;IAACR,IAAI;IAAEC,KAAK;IAAEQ,KAAK;IAAES,MAAM;IAAEhB;EAAS,CAAC;AAClD,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}