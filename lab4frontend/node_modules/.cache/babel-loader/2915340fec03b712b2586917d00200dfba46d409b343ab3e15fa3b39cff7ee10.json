{"ast":null,"code":"import { createRouter, createWebHistory } from 'vue-router';\nimport { useAuthStore } from \"@/auth\";\nimport StartPage from \"@/components/StartPage.vue\";\nimport MainPage from \"@/components/MainPage.vue\";\nimport RegisterPage from \"@/components/RegisterPage.vue\";\nconst routes = [{\n  path: \"/login\",\n  component: StartPage\n}, {\n  path: \"/main\",\n  component: MainPage,\n  meta: {\n    obligatoryAuth: true\n  }\n}, {\n  path: \"/register\",\n  Component: RegisterPage\n}];\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n});\nrouter.beforeEach(async (to, from, next) => {\n  const authStore = useAuthStore();\n  if (to.meta.obligatoryAuth && !authStore.user) {\n    try {\n      await authStore.fetchUser();\n    } catch (err) {\n      return next(\"/register\");\n    }\n  }\n  next();\n});\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","useAuthStore","StartPage","MainPage","RegisterPage","routes","path","component","meta","obligatoryAuth","Component","router","history","beforeEach","to","from","next","authStore","user","fetchUser","err"],"sources":["C:/study/labs/web/labwork4/lab4frontend/src/route.js"],"sourcesContent":["import {createRouter, createWebHistory} from 'vue-router';\r\nimport {useAuthStore} from \"@/auth\";\r\nimport StartPage from \"@/components/StartPage.vue\";\r\nimport MainPage from \"@/components/MainPage.vue\";\r\nimport RegisterPage from \"@/components/RegisterPage.vue\";\r\n\r\nconst routes = [\r\n    {path: \"/login\", component: StartPage},\r\n    {path: \"/main\", component: MainPage, meta: {obligatoryAuth: true}},\r\n    {path: \"/register\", Component: RegisterPage},\r\n];\r\n\r\nconst router = createRouter({\r\n    history: createWebHistory(),\r\n    routes,\r\n});\r\n\r\nrouter.beforeEach(async (to, from, next) => {\r\n    const authStore = useAuthStore();\r\n    if (to.meta.obligatoryAuth && !authStore.user) {\r\n        try {\r\n            await authStore.fetchUser();\r\n        } catch (err) {\r\n            return next(\"/register\");\r\n        }\r\n    }\r\n    next();\r\n})\r\nexport default router;"],"mappings":"AAAA,SAAQA,YAAY,EAAEC,gBAAgB,QAAO,YAAY;AACzD,SAAQC,YAAY,QAAO,QAAQ;AACnC,OAAOC,SAAS,MAAM,4BAA4B;AAClD,OAAOC,QAAQ,MAAM,2BAA2B;AAChD,OAAOC,YAAY,MAAM,+BAA+B;AAExD,MAAMC,MAAM,GAAG,CACX;EAACC,IAAI,EAAE,QAAQ;EAAEC,SAAS,EAAEL;AAAS,CAAC,EACtC;EAACI,IAAI,EAAE,OAAO;EAAEC,SAAS,EAAEJ,QAAQ;EAAEK,IAAI,EAAE;IAACC,cAAc,EAAE;EAAI;AAAC,CAAC,EAClE;EAACH,IAAI,EAAE,WAAW;EAAEI,SAAS,EAAEN;AAAY,CAAC,CAC/C;AAED,MAAMO,MAAM,GAAGZ,YAAY,CAAC;EACxBa,OAAO,EAAEZ,gBAAgB,CAAC,CAAC;EAC3BK;AACJ,CAAC,CAAC;AAEFM,MAAM,CAACE,UAAU,CAAC,OAAOC,EAAE,EAAEC,IAAI,EAAEC,IAAI,KAAK;EACxC,MAAMC,SAAS,GAAGhB,YAAY,CAAC,CAAC;EAChC,IAAIa,EAAE,CAACN,IAAI,CAACC,cAAc,IAAI,CAACQ,SAAS,CAACC,IAAI,EAAE;IAC3C,IAAI;MACA,MAAMD,SAAS,CAACE,SAAS,CAAC,CAAC;IAC/B,CAAC,CAAC,OAAOC,GAAG,EAAE;MACV,OAAOJ,IAAI,CAAC,WAAW,CAAC;IAC5B;EACJ;EACAA,IAAI,CAAC,CAAC;AACV,CAAC,CAAC;AACF,eAAeL,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}