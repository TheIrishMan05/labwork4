{"ast":null,"code":"import { createRouter, createWebHistory } from 'vue-router';\nimport { useAuthStore } from \"@/auth\";\nimport StartPage from \"@/components/startPage.vue\";\nimport MainPage from \"@/components/mainPage.vue\";\nconst routes = [{\n  path: \"/\",\n  component: StartPage\n}, {\n  path: \"/main\",\n  component: MainPage,\n  meta: {\n    obligatoryAuth: true\n  }\n}];\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n});\nrouter.beforeEach(async (to, from, next) => {\n  const authStore = useAuthStore();\n  if (to.meta.obligatoryAuth && !authStore.user) {\n    try {\n      await authStore.fetchUser();\n    } catch (err) {\n      return next(\"/\");\n    }\n  }\n  if (to.meta.obligatoryAuth && !authStore.user) {\n    return next(\"/\");\n  }\n  next();\n});\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","useAuthStore","StartPage","MainPage","routes","path","component","meta","obligatoryAuth","router","history","beforeEach","to","from","next","authStore","user","fetchUser","err"],"sources":["C:/study/labs/web/labwork4/lab4frontend/src/route.js"],"sourcesContent":["import {createRouter, createWebHistory} from 'vue-router';\r\nimport {useAuthStore} from \"@/auth\";\r\nimport StartPage from \"@/components/startPage.vue\";\r\nimport MainPage from \"@/components/mainPage.vue\";\r\n\r\nconst routes = [\r\n    {path: \"/\", component: StartPage},\r\n    {path: \"/main\", component: MainPage, meta: {obligatoryAuth: true}},\r\n];\r\n\r\nconst router = createRouter({\r\n    history: createWebHistory(),\r\n    routes,\r\n});\r\n\r\nrouter.beforeEach(async (to, from, next) => {\r\n    const authStore = useAuthStore();\r\n    if (to.meta.obligatoryAuth && !authStore.user) {\r\n        try {\r\n            await authStore.fetchUser();\r\n        } catch (err) {\r\n            return next(\"/\");\r\n        }\r\n    }\r\n    if (to.meta.obligatoryAuth && !authStore.user) {\r\n        return next(\"/\")\r\n    }\r\n    next();\r\n})\r\nexport default router;"],"mappings":"AAAA,SAAQA,YAAY,EAAEC,gBAAgB,QAAO,YAAY;AACzD,SAAQC,YAAY,QAAO,QAAQ;AACnC,OAAOC,SAAS,MAAM,4BAA4B;AAClD,OAAOC,QAAQ,MAAM,2BAA2B;AAEhD,MAAMC,MAAM,GAAG,CACX;EAACC,IAAI,EAAE,GAAG;EAAEC,SAAS,EAAEJ;AAAS,CAAC,EACjC;EAACG,IAAI,EAAE,OAAO;EAAEC,SAAS,EAAEH,QAAQ;EAAEI,IAAI,EAAE;IAACC,cAAc,EAAE;EAAI;AAAC,CAAC,CACrE;AAED,MAAMC,MAAM,GAAGV,YAAY,CAAC;EACxBW,OAAO,EAAEV,gBAAgB,CAAC,CAAC;EAC3BI;AACJ,CAAC,CAAC;AAEFK,MAAM,CAACE,UAAU,CAAC,OAAOC,EAAE,EAAEC,IAAI,EAAEC,IAAI,KAAK;EACxC,MAAMC,SAAS,GAAGd,YAAY,CAAC,CAAC;EAChC,IAAIW,EAAE,CAACL,IAAI,CAACC,cAAc,IAAI,CAACO,SAAS,CAACC,IAAI,EAAE;IAC3C,IAAI;MACA,MAAMD,SAAS,CAACE,SAAS,CAAC,CAAC;IAC/B,CAAC,CAAC,OAAOC,GAAG,EAAE;MACV,OAAOJ,IAAI,CAAC,GAAG,CAAC;IACpB;EACJ;EACA,IAAIF,EAAE,CAACL,IAAI,CAACC,cAAc,IAAI,CAACO,SAAS,CAACC,IAAI,EAAE;IAC3C,OAAOF,IAAI,CAAC,GAAG,CAAC;EACpB;EACAA,IAAI,CAAC,CAAC;AACV,CAAC,CAAC;AACF,eAAeL,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}